<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>AUROTA PHOTOGRAPHY</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Locomotive Scroll CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.css"
    />
    <!-- Custom CSS -->
    <link rel="stylesheet" type="text/css" href="style.css" />

    <!-- GSAP & ScrollTrigger -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
  </head>
  <body>
    <!-- Locomotive Scroll Container -->
    <div data-scroll-container id="smooth-wrapper">

      <!-- NAVIGATION -->
      <nav class="navbar">
        <div class="logo">Aurora</div>
        <ul class="nav-link">
          <li><a href="#">Home</a></li>
          <li><a href="#">About</a></li>
          <li><a href="#">Journal</a></li>
          <li><a href="#">Contact</a></li>
          <li><a href="#">Studio</a></li>
        </ul>
        <div class="social">
          <a href="#"><img src="facebook.png" alt="facebook" /></a>
          <a href="#"><img src="instagram.png" alt="instagram" /></a>
          <a href="#"><img src="twitter.png" alt="twitter" /></a>
        </div>
      </nav>

      <!-- SECTION 1: Hero -->
      <section class="section-hero">
        <div class="hero-content">
          <div class="hero">
            <h1 class="hero-1">CREATE IMPACT</h1>
            <div class="sub2-container">
              <hr>
              <p>&nbsp;SCROLL & EXPLORE&nbsp;</p>
              <hr>
            </div>
          </div>
        </div>
      </section>

      <!-- SECTION 2: Expandable Video -->
      <section class="section-video">
        <div class="text">
          We offer prestigious and well organised photography service
        </div>
        <div class="text2">
          Authentically uncover the art of YOU
        </div>
        <div class="video-block">
          <div class="video-block__container">
            <figure class="video">
              <!-- Updated video src using the provided URL -->
              <video
                autoplay
                loop
                muted
                playsinline
                src="https://pub-9f13b906b3ec4b04ad21dcfb9b9b6197.r2.dev/mixkit-people-pouring-a-warm-drink-around-a-campfire-513-full-hd.mp4"
              ></video>
              <figcaption class="video__caption" style="left: 45%; top: 50%;">
                <span class="mid">FILM THE MOMENT</span>
              </figcaption>
              <figcaption class="video__caption" style="left: 24px; bottom: 12px;">
                <span>Capture the world through lens</span>
              </figcaption>
            </figure>
          </div>
        </div>
      </section>

      <!-- SECTION 3: End Content -->
      <section class="section-end">
        <div class="box-container">
          <div class="img">
            <!-- Changed <image> to standard <img> tag -->
            <img class="fullpage" src="alexander-dummer-aS4Duj2j7r4-unsplash.jpg" alt="aurora" />
          </div>
          <div class="box-1">
            <div class="heading">
              <h1>BOOK With</h1>
            </div>
            <div class="subheading">
              <p>
                It represents a lorem ipsum journey of exploration and discovery, pushing the boundaries of creativity and technology. Through this piece, a vision is expressed and ideas are communicated that might be difficult to convey through words alone. The collaboration with artificial intelligence adds a layer of unpredictability and innovation, making each creation a unique fusion of human intuition and machine-generated creativity.
              </p>
            </div>
          </div>
          <div class="end">
            <p>Pure HTML/CSS and Js script</p>
          </div>
        </div>
      </section>

    </div> <!-- /#smooth-wrapper -->

    <!-- Locomotive Scroll JS -->
    <script src="https://cdn.jsdelivr.net/npm/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.js"></script>

    <!-- Main JS for GSAP + ScrollTrigger -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        /* 1) Initialize Locomotive Scroll */
        const locoScroll = new LocomotiveScroll({
          el: document.querySelector('[data-scroll-container]'),
          smooth: true
        });

        /* 2) Setup GSAP ScrollTrigger to sync with Locomotive */
        gsap.registerPlugin(ScrollTrigger);
        ScrollTrigger.scrollerProxy("#smooth-wrapper", {
          scrollTop(value) {
            return arguments.length
              ? locoScroll.scrollTo(value, 0, 0)
              : locoScroll.scroll.instance.scroll.y;
          },
          getBoundingClientRect() {
            return {
              top: 0,
              left: 0,
              width: window.innerWidth,
              height: window.innerHeight
            };
          },
          pinType: document.querySelector("#smooth-wrapper").style.transform ? "transform" : "fixed"
        });

        locoScroll.on("scroll", ScrollTrigger.update);
        ScrollTrigger.addEventListener("refresh", () => locoScroll.update());
        ScrollTrigger.refresh();

        /* 3) Expandable Video Logic */
        const expandableVideoBlock = () => {
          // Use a custom CSS var for max container width (fallback to 800)
          const maxWidth = parseInt(
            getComputedStyle(document.documentElement)
              .getPropertyValue('--container-width')
          ) || 800;
          const gap = 24;

          // Grab elements
          const element = document.querySelector(".video-block");
          if (!element) return;

          const container = element.querySelector(".video-block__container");
          const figure = element.querySelector("figure.video");
          const video = element.querySelector("video");
          const captions = figure.querySelectorAll(".video__caption span");
          const midCaption = document.querySelector(".video__caption .mid");

          // Track video status
          let isPlaying = false;
          video.onplaying = () => (isPlaying = true);
          video.onpause = () => (isPlaying = false);

          function videoPause() {
            if (video && !video.paused && isPlaying) {
              video.pause();
              // Move captions out of view
              gsap.to(captions, { y: "100%", duration: 0.5, stagger: 0.1 });
            }
          }
          async function videoPlay() {
            if (video && video.paused && !isPlaying) {
              // Bring captions into view
              gsap.to(captions, { y: "0%", duration: 0.5, stagger: 0.1 });
              return await video.play();
            }
          }

          // Returns a dynamic clip-path based on window size
          function getClipPath() {
            let insetX = (window.innerWidth - maxWidth - gap) / 3;
            let insetY = (window.innerHeight - maxWidth - gap) / 3;
            if (insetX < gap) insetX = gap;
            if (insetY < gap) insetY = gap;
            return `inset(${insetY}px ${insetX}px)`;
          }

          // Parallax effect on figure while scrolling into view
          gsap.fromTo(
            figure,
            { clipPath: getClipPath, y: "-50%" },
            {
              scrollTrigger: {
                scroller: "#smooth-wrapper",
                trigger: element,
                start: "top bottom",
                end: "top top",
                scrub: true
              },
              y: "0%",
              duration: 0.5,
              onStart: () => videoPause()
            }
          );

          // Main timeline: pin the container & animate clip-path
          let tl = gsap.timeline({
            scrollTrigger: {
              scroller: "#smooth-wrapper",
              trigger: container,
              start: "top top",
              end: () => window.innerHeight * 2,
              scrub: true,
              pin: true
            }
          });
          const headline = document.querySelector(".text");
          const subhead = document.querySelector(".text2");
          tl.to(subhead, { opacity: 1, y: "55%", duration: 0.5 }, ">");
          tl.to(headline, { opacity: 1, y: "55%", duration: 0.5 }, ">");
          tl.to(midCaption, { opacity: 1, y: "55%", duration: 0.5 }, ">");
          
          tl.fromTo(
            figure,
            { clipPath: getClipPath },
            {
              clipPath: "inset(0px 0px)",
              duration: 0.5,
              onUpdate: () => videoPause(),
              onComplete: () => videoPlay()
            }
          );

          // Hold the video playing for a moment
          tl.fromTo(
            figure,
            { opacity: 1 },
            {
              opacity: 1,
              duration: 1,
              onUpdate: () => videoPlay(),
              onComplete: () => videoPause()
            }
          );

          // Shrink video block back to clipped
          tl.fromTo(
            figure,
            { clipPath: "inset(0px 0px)" },
            {
              clipPath: getClipPath,
              duration: 0.5
            }
          );
        };

        // Initialize the video expand logic
        expandableVideoBlock();
      });
    </script>
  </body>
</html>
